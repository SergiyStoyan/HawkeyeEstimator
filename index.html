<html>
<head>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

</head>

<body>
7
<script>

window.googleDocCallback = function () {console.log('!!!'); return true; };

  var scriptId = 'AKfycbyz89pDnOcqfS_l-69w-MW3NiNVkGmQgFoKQ_90eeVg';
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function () {
    if (this.readyState != 4) 
      return;
    if (this.status == 200) {
      var data = JSON.parse(this.responseText);
      console.log('test', data);
      return;
    }
      if (this.status === 302) {
        var location = this.getResponseHeader("Location");
        return ajax.call(this, location, callback);
      } 
    console.log('test2', this.status, '_' + this.statusText, '_' + this.getResponseHeader("Location"));
  };

  xhr.open("GET", 'https://script.google.com/macros/s/AKfycbyz89pDnOcqfS_l-69w-MW3NiNVkGmQgFoKQ_90eeVg/dev?action=test&callback=googleDocCallback', true);
  xhr.withCredentials = true;
  xhr.setRequestHeader('Content-Type', 'text/plain');
  xhr.send();

  /*xhr.open("POST", 'https://script.googleapis.com/v1/scripts/' + scriptId + ':run', true);
  xhr.withCredentials = true;
  //xhr.setRequestHeader("Authorization", "Bearer ### access token ###");
  //xhr.setRequestHeader('Content-Type', 'application/json');
  //xhr.setRequestHeader("Origin", 'https://script.google.com');
  xhr.send(JSON.stringify({
    function: 'test',
    parameters: [
      'qwerty1',
    ],
    //"sessionState": string,
    devMode: true,
  }));*/


$.ajax({
	crossDomain: true,
	url: 'https://script.google.com/macros/s/AKfycbyz89pDnOcqfS_l-69w-MW3NiNVkGmQgFoKQ_90eeVg/dev?action=test',
	method: "GET",
	dataType: "jsonp",
}).done(function(e) {
	console.log('ajax2', e);
}).fail(function( jqXHR, e ) {
	console.log('ajax3', e);
});

var f = fetch('https://script.google.com/macros/s/AKfycbyz89pDnOcqfS_l-69w-MW3NiNVkGmQgFoKQ_90eeVg/dev?action=test', {
	redirect: "follow",
	method: "GET",
	//body: JSON.stringify(DATA),
	mode: 'cors',
	headers: {
	"Content-Type": "text/plain;charset=utf-8",
	},
});
console.log('fetch', f);


</script>


</body>
</html>